<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FotoShare Cloud</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-950 text-white flex flex-col items-center justify-center min-h-screen p-6">

  <h1 class="text-4xl font-bold mb-4">📡 FotoShare Cloud</h1>
  <p class="text-gray-400 mb-6 text-center">Upload gambar kamu ke cloud publik secara gratis dan mudah</p>

  <label
    for="file-upload"
    class="w-full max-w-md p-6 border-2 border-dashed border-gray-600 rounded-xl flex flex-col items-center justify-center cursor-pointer hover:border-blue-400 transition"
  >
    <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-blue-400 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1M12 12v9m0 0l-3-3m3 3l3-3M12 3v9"/>
    </svg>
    <span class="text-gray-300 text-sm">Klik atau drag gambar ke sini</span>
    <input id="file-upload" type="file" accept="image/*" class="hidden" />
  </label>

  <img id="preview" class="mt-6 max-w-md w-full rounded-lg shadow-lg hidden" />

  <button
    onclick="handleUpload()"
    id="upload-btn"
    class="mt-4 bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-full hidden"
  >
    🚀 Upload ke Cloud
  </button>

  <p id="status" class="mt-6 text-green-400 font-semibold text-center"></p>

  <footer class="mt-10 text-sm text-gray-500 text-center">
    © 2025 FotoShare Cloud | <a href="/gallery.html" class="underline text-blue-400 hover:text-blue-500">Galeri Publik</a>
  </footer>

  <script>
    const fileInput = document.getElementById("file-upload");
    const preview = document.getElementById("preview");
    const uploadBtn = document.getElementById("upload-btn");
    const statusText = document.getElementById("status");
    let file = null;

    fileInput.addEventListener("change", (e) => {
      file = e.target.files[0];
      if (file) {
        preview.src = URL.createObjectURL(file);
        preview.classList.remove("hidden");
        uploadBtn.classList.remove("hidden");
      }
    });

    async function handleUpload() {
      if (!file) return alert("Pilih gambar dulu!");

      const reader = new FileReader();
      reader.readAsDataURL(file);

      reader.onloadend = async () => {
        const base64 = reader.result.split(",")[1];
        const fileName = `${Date.now()}-${file.name}`;

        const res = await fetch("/api/upload", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ fileName, content: base64 }),
        });

        const data = await res.json();
        statusText.innerText = data.message || "❌ Upload gagal!";
        file = null;
        fileInput.value = "";
        uploadBtn.classList.add("hidden");
      };
    }
  </script>
</body>
</html>
